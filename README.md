# Google Sheets Attendance Tool

這是一個 Google Apps Script (GAS) 專案，提供 Google 試算表的點名工具。使用者可以自動建立點名單，設定下拉式選單，並根據點名狀況計算出席成績。

## 功能
- 透過工具列按鈕「產生點名單」來自動建立點名表。
- 使用者輸入課程起始日期與週數，系統自動計算每週日期。
- 設定固定欄位 (學號、班級、座號、姓名) 並凍結標題列。
- 產生對應週次的標題列 (格式: MM/DD)。
- 點名欄位使用下拉式選單，包括: `準時`、`公假`、`事病假`、`5-15分內`、`15-25分內`、`缺席`。
- 自動計算出席成績，當週沒有點名則不納入計算。
- **新增功能**: 在點名單最上方自動插入出席成績計算標準，合併儲存格並自動換行。

## 出席成績計算方式
| 狀態       | 分數 |
|------------|------|
| 準時       | 2.0  |
| 公假       | 1.8  |
| 事病假     | 1.7  |
| 5-15 分內  | 1.5  |
| 15-25 分內 | 1.0  |
| 缺席       | 0.0  |

出席成績計算公式:
```excel
=IF(COUNTA(E2:X2)=0, "", AVERAGE(FILTER(IF(E2:X2="準時", 2, IF(E2:X2="公假", 1.8, IF(E2:X2="事病假", 1.7, IF(E2:X2="5-15分內", 1.5, IF(E2:X2="15-25分內", 1, IF(E2:X2="缺席", 0, "")))))), E2:X2<>""))*50)
```

## 安裝方式
1. 開啟 Google 試算表，點選 `擴充功能 > Apps Script`。
2. 複製 `attendance.gs` 內的程式碼，貼到 Apps Script 編輯器。
3. 儲存並重新載入試算表，即可在 `點名工具` 菜單中找到 `產生點名單` 按鈕。

## `attendance.gs` 內容
請參閱專案的 `attendance.gs` 檔案以獲取完整的 Apps Script 代碼。
